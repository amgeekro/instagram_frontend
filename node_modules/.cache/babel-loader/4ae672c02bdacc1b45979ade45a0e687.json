{"ast":null,"code":"import _slicedToArray from \"/Users/amirhosein/Documents/project/fast_api/instagram_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/amirhosein/Documents/project/fast_api/instagram_frontend/src/imageUpload.js\";\nimport React, { useState } from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport './imageUpload.css';\nvar BASE_URL = \"http://localhost:8000/\";\nfunction ImageUpload(authToken, authTokenType, userId) {\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    caption = _useState2[0],\n    setCaption = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    image = _useState4[0],\n    setImage = _useState4[1];\n  var handleChange = function handleChange(e) {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n    }\n  };\n  var handleUpload = function handleUpload(e) {\n    e.preventDefault();\n    var formData = new FormData();\n    formData.append('image', image);\n    var requestOption = {\n      method: 'POST',\n      headers: new Headers({\n        'Authorization': authTokenType + ' ' + authToken\n      }),\n      body: formData\n    };\n    fetch(BASE_URL + 'post/image', requestOption).then(function (response) {\n      if (response.ok) {\n        return response.json();\n      }\n      throw response;\n    }).then(function (data) {\n      createPost(data.filename);\n    }).catch(function (error) {\n      console.log(error);\n    }).finally(function () {\n      setCaption('');\n      setImage(null);\n      document.getElementById('fileInput').value = null;\n    });\n  };\n  var createPost = function createPost(imageUrl) {\n    var json_string = JSON.stringify({\n      'image_url': imageUrl,\n      'image_url_type': 'relative',\n      'caption': caption,\n      'creator_id': userId\n    });\n    var requestOption = {\n      method: 'POST',\n      headers: new Headers({\n        'Authorization': authTokenType + ' ' + authToken,\n        'Content-Type': 'application/json'\n      }),\n      body: json_string\n    };\n    fetch(BASE_URL + 'post', requestOption).then(function (response) {\n      if (response.ok) {\n        return response.json();\n      }\n      throw response;\n    }).then(function (data) {\n      window.location.reload();\n      window.scrollTo();\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"imageupload\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Enter a caption\",\n    onChange: function onChange(event) {\n      return setCaption(event.target.value);\n    },\n    value: caption,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    id: \"fileInput\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    className: \"imageupload_button\",\n    onClick: handleUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, \"Upload\"));\n}\nexport default ImageUpload;","map":{"version":3,"names":["React","useState","Button","BASE_URL","ImageUpload","authToken","authTokenType","userId","caption","setCaption","image","setImage","handleChange","e","target","files","handleUpload","preventDefault","formData","FormData","append","requestOption","method","headers","Headers","body","fetch","then","response","ok","json","data","createPost","filename","catch","error","console","log","finally","document","getElementById","value","imageUrl","json_string","JSON","stringify","window","location","reload","scrollTo","event"],"sources":["/Users/amirhosein/Documents/project/fast_api/instagram_frontend/src/imageUpload.js"],"sourcesContent":["import React, {useState} from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport './imageUpload.css'\n\nconst BASE_URL = \"http://localhost:8000/\";\n\nfunction ImageUpload (authToken, authTokenType, userId) {\n    const [caption, setCaption] = useState('')\n    const [image, setImage] = useState(null)\n\n    const handleChange = (e) => {\n        if (e.target.files[0]) {\n            setImage(e.target.files[0])\n        }\n    }\n\n    const handleUpload = (e) => {\n        e.preventDefault()\n        const formData = new FormData();\n        formData.append('image', image)\n\n        const requestOption = {\n            method: 'POST',\n            headers: new Headers({\n                'Authorization': authTokenType + ' ' + authToken\n            }),\n            body: formData\n        }\n\n        fetch(BASE_URL + 'post/image', requestOption)\n        .then(response => {\n            if(response.ok) {\n                return response.json()\n            }\n            throw response\n        }).then(data => {\n            createPost(data.filename)\n        }).catch(error => {\n            console.log(error)\n        }).finally(() => {\n            setCaption('');\n            setImage(null);\n            document.getElementById('fileInput').value = null;\n        })\n\n\n    }\n\n    const createPost = (imageUrl) => {\n        const json_string = JSON.stringify({\n            'image_url': imageUrl,\n            'image_url_type': 'relative',\n            'caption': caption,\n            'creator_id': userId\n        })\n        const requestOption = {\n            method: 'POST',\n            headers: new Headers({\n                'Authorization': authTokenType + ' ' + authToken,\n                'Content-Type': 'application/json'\n            }),\n            body: json_string\n        }\n\n        fetch(BASE_URL + 'post', requestOption)\n        .then(response => {\n            if(response.ok) {\n                return response.json()\n            }\n            throw response\n        }).then(data => {\n            window.location.reload()\n            window.scrollTo()\n        }).catch(error => {\n            console.log(error)\n        })\n\n    }\n\n    return (\n        <div className=\"imageupload\">\n            <input type='text' placeholder=\"Enter a caption\" onChange={(event) => setCaption(event.target.value)} value={caption}/>\n            <input type='file' id=\"fileInput\" onChange={handleChange}/>\n            <Button className=\"imageupload_button\" onClick={handleUpload}>Upload</Button>\n        </div>\n    )\n}\n\nexport default ImageUpload;"],"mappings":"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"},"metadata":{},"sourceType":"module"}