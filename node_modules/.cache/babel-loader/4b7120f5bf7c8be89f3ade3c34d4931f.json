{"ast":null,"code":"import _slicedToArray from \"/Users/amirhosein/Documents/project/fast_api/instagram_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/amirhosein/Documents/project/fast_api/instagram_frontend/src/Post.js\";\nimport React, { useState, useEffect } from \"react\";\nimport './Post.css';\nimport { Avatar, Button } from \"@material-ui/core\";\nvar BASE_URL = \"http://localhost:8000/\";\nfunction Post(_ref) {\n  var _this = this;\n  var post = _ref.post,\n    authToken = _ref.authToken,\n    authTokenType = _ref.authTokenType,\n    username = _ref.username;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    imageUrl = _useState2[0],\n    setImageUrl = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    comments = _useState4[0],\n    setComments = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    newComment = _useState6[0],\n    setnewComment = _useState6[1];\n  useEffect(function () {\n    if (post.image_url_type === 'absolute') {\n      setImageUrl(post.image_url);\n    } else {\n      setImageUrl(BASE_URL + post.image_url);\n    }\n  }, []);\n  useEffect(function () {\n    setComments(post.comments);\n  }, []);\n  var handleDelete = function handleDelete(event) {\n    event.preventDefault();\n    var requestOptions = {\n      method: \"GET\",\n      headers: new Headers({\n        \"Authorization\": authTokenType + \" \" + authToken\n      })\n    };\n    fetch(BASE_URL + 'post/delete/' + post.id, requestOptions).then(function (response) {\n      if (response.ok) {\n        window.location.reload();\n      }\n      throw response;\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n  var postComment = function postComment(event) {\n    event.preventDefault();\n    var json_string = JSON.stringify({\n      'username': username,\n      'text': newComment,\n      'post_id': post.id\n    });\n    var requestOptions = {\n      method: \"POST\",\n      headers: new Headers({\n        \"Authorization\": authTokenType + \" \" + authToken,\n        \"Content-Type\": 'application/json'\n      }),\n      body: json_string\n    };\n    fetch(BASE_URL + 'comment/' + post.id, requestOptions).then(function (response) {\n      if (response.ok) {\n        return response.json();\n      }\n      throw response;\n    }).then(function (data) {}).catch(function (error) {\n      console.log(error);\n    }).finally(function () {\n      setnewComment('');\n    });\n    var fetchComments = function fetchComments() {};\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"post\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"post_header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    alt: \"user image\",\n    src: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"post_headerInfo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 21\n    }\n  }, post.user.username), /*#__PURE__*/React.createElement(Button, {\n    className: \"post_delete\",\n    onClick: handleDelete,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 21\n    }\n  }, \"Delete\"))), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"post_image\",\n    src: imageUrl,\n    alt: \"post_image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"post_caption\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, post.caption), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"post_comments\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, comments.map(function (comment) {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 29\n      }\n    }, comment.username, \":\"), \" \", comment.text);\n  })), authToken && /*#__PURE__*/React.createElement(\"form\", {\n    className: \"post_commentbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"post_input\",\n    type: \"text\",\n    placeholder: \"Add a comment\",\n    value: newComment,\n    onChange: function onChange(e) {\n      return setnewComment(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"post_button\",\n    type: \"submit\",\n    disabled: !newComment,\n    onClick: postComment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }, \"Post\")));\n}\nexport default Post;","map":{"version":3,"names":["React","useState","useEffect","Avatar","Button","BASE_URL","Post","post","authToken","authTokenType","username","imageUrl","setImageUrl","comments","setComments","newComment","setnewComment","image_url_type","image_url","handleDelete","event","preventDefault","requestOptions","method","headers","Headers","fetch","id","then","response","ok","window","location","reload","catch","error","console","log","postComment","json_string","JSON","stringify","body","json","data","finally","fetchComments","user","caption","map","comment","text","e","target","value"],"sources":["/Users/amirhosein/Documents/project/fast_api/instagram_frontend/src/Post.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport './Post.css';\nimport { Avatar, Button } from \"@material-ui/core\";\n\nconst BASE_URL = \"http://localhost:8000/\";\n\nfunction Post({post, authToken, authTokenType, username}) {\n    const [imageUrl, setImageUrl] = useState('');\n    const [comments, setComments] = useState([]);\n    const [newComment, setnewComment] = useState('');\n\n    useEffect(() => {\n        if (post.image_url_type === 'absolute'){\n            setImageUrl(post.image_url)\n        } else {\n            setImageUrl(BASE_URL + post.image_url)\n        }\n    }, [])\n\n    useEffect(() => {\n        setComments(post.comments)\n    }, [])\n\n    const handleDelete = (event) => {\n        event.preventDefault()\n        const requestOptions = {\n            method: \"GET\",\n            headers: new Headers({\n                \"Authorization\": authTokenType + \" \" + authToken\n            })\n        }\n\n        fetch(BASE_URL + 'post/delete/' + post.id, requestOptions)\n        .then(response => {\n            if(response.ok) {\n                window.location.reload()\n            }\n            throw response\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n    const postComment = (event) => {\n        event.preventDefault()\n        const json_string = JSON.stringify({\n            'username': username,\n            'text': newComment,\n            'post_id': post.id\n        })\n        const requestOptions = {\n            method: \"POST\",\n            headers: new Headers({\n                \"Authorization\": authTokenType + \" \" + authToken,\n                \"Content-Type\": 'application/json'\n            }),\n            body: json_string\n        }\n\n        fetch(BASE_URL + 'comment/' + post.id, requestOptions)\n        .then(response => {\n            if(response.ok) {\n                return response.json()\n            }\n            throw response\n        }).then(data => {\n\n        })\n        .catch(error => {\n            console.log(error)\n        }).finally(() => {\n            setnewComment('')\n        })\n\n        const fetchComments = () => {\n            \n        }\n    }\n\n    return (\n        <div className=\"post\">\n            <div className=\"post_header\">\n                <Avatar alt=\"user image\" src=\"\"/>\n                <div className=\"post_headerInfo\">\n                    <h3>{post.user.username}</h3>\n                    <Button className=\"post_delete\" onClick={handleDelete}>Delete</Button>\n                </div>\n            </div>\n            <img className=\"post_image\" src={imageUrl} alt=\"post_image\"/>\n            <h4 className=\"post_caption\">{post.caption}</h4>\n\n            <div className=\"post_comments\">\n                {\n                    comments.map((comment) => (\n                        <p>\n                            <strong>{comment.username}:</strong> {comment.text}\n                        </p>\n                    ))\n                }\n            </div>\n\n            {authToken && (\n                <form className=\"post_commentbox\">\n                    <input className=\"post_input\" type='text' placeholder=\"Add a comment\"\n                     value={newComment} onChange={(e) => setnewComment(e.target.value)}/>\n                    <button className=\"post_button\" type=\"submit\" disabled={!newComment} onClick={postComment}>Post</button>\n                </form>\n            )}\n        </div>\n    )\n}\n\nexport default Post;"],"mappings":"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"},"metadata":{},"sourceType":"module"}